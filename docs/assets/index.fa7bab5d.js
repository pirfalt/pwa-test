import{j as N,O as R,L as _,l as E,r as i,u as F,R as L,a as j,B as A,b as C,c as g}from"./vendor.56e6658f.js";const O=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function a(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerpolicy&&(e.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?e.credentials="include":o.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function c(o){if(o.ep)return;o.ep=!0;const e=a(o);fetch(o.href,e)}};O();var b="/pwa-test/assets/checkbox.bce85b74.svg";const $="_App_1x353_1",P="_Header_1x353_14",B="_Footer_1x353_28";var f={App:$,Header:P,Footer:B,"Footer-item":"_Footer-item_1x353_37"};const t=N.exports.jsx,d=N.exports.jsxs,I=N.exports.Fragment;function M(){return d("div",{className:f.App,children:[t(H,{}),t("main",{children:t(R,{})}),t(W,{})]})}function H(){return t(_,{to:"/",children:d("header",{className:f.Header,children:[t("h1",{children:"PWA test"}),t("img",{src:b,className:f["App-logo"],alt:"logo"})]})})}function W(){return d("footer",{className:f.Footer,children:[d(_,{to:"/",className:f["Footer-item"],children:[t("img",{src:b,alt:"logo"}),t("span",{children:"todo"})]}),d(_,{to:"/sync",className:f["Footer-item"],children:[t("img",{src:b,alt:"logo"}),t("span",{children:"sync"})]}),d(_,{to:"/about",className:f["Footer-item"],children:[t("img",{src:b,alt:"logo"}),t("span",{children:"about"})]})]})}var u={"Todo-list":"_Todo-list_1spee_1","Todo-list-item":"_Todo-list-item_1spee_12","Todo-row-box":"_Todo-row-box_1spee_20","Todo-row-label":"_Todo-row-label_1spee_27","Todo-row-checkbox":"_Todo-row-checkbox_1spee_33","Todo-row-button":"_Todo-row-button_1spee_38","Todo-input-box":"_Todo-input-box_1spee_44","Todo-input-text":"_Todo-input-text_1spee_51","Todo-input-button":"_Todo-input-button_1spee_58"};const q={name:"PWA test",storeName:"pwa_test",version:1,description:"Offline storage for the app data"},T=E.createInstance(q),w="tasks";async function U(){if(await T.getItem(w)!=null)return;const r=[{text:"Build tools",checked:!0},{text:"Create page layout",checked:!0},{text:"Input fields",checked:!0},{text:"Offline data storage",checked:!0},{text:"Upload images",checked:!1}];await T.setItem(w,r)}function K(){const[n,r]=i.exports.useState([]);i.exports.useEffect(()=>{T.getItem(w).then(e=>r(e!=null?e:[])).catch(e=>console.error("failed to load!",e))},[]),i.exports.useEffect(()=>{T.setItem(w,n).catch(e=>console.error("failed to save!",e))},[n]);const a=e=>{const s=[...n];s[e].checked=!s[e].checked,r(s)},c=e=>{const s=[...n,e];r(s)},o=e=>{const s=n.filter((p,m)=>m!=e);r(s)};return d("ol",{className:u["Todo-list"],children:[n.map((e,s)=>t("li",{className:u["Todo-list-item"],children:d("div",{className:u["Todo-row-box"],children:[d("label",{className:u["Todo-row-label"],children:[t("input",{type:"checkbox",className:u["Todo-row-checkbox"],name:`${s}_${e.text}`,checked:e.checked,onChange:()=>a(s)}),e.text]}),t("button",{className:u["Todo-row-button"],onClick:p=>{p.preventDefault(),o(s)},children:"Remove"})]})},s)),t(V,{addItem:c})]})}function V({addItem:n}){return t("li",{className:u["Todo-list-item"],children:d("form",{className:u["Todo-input-box"],onSubmit:r=>{r.preventDefault();const c=new FormData(r.currentTarget).get("new-item");c!=null&&(c instanceof File||(n({text:c,checked:!1}),r.currentTarget.reset()))},children:[t("input",{className:u["Todo-input-text"],name:"new-item",type:"text",placeholder:"New todo item..."}),t("button",{type:"submit",className:u["Todo-input-button"],children:"Add"})]})})}function z(){const n=F();return t("form",{onSubmit:r=>{r.preventDefault()},children:t("input",{className:u["TodoItem-text"],name:"text",type:"text",placeholder:`Todo item ${n.todoId}...`})})}const G="_Sync_pkdpd_1";var J={Sync:G};function Q(){return t("div",{className:J.Sync,children:"Sync"})}function X(n={video:{facingMode:"environment"},audio:!1}){const{devices:r,error:a}=Y(),{setConstraints:c,stream:o,error:e}=Z(n),s=o==null?void 0:o.getTracks().map(p=>p.getSettings().deviceId);return{devices:r,activeDeviceIds:s,setConstraints:c,stream:o,error:a!=null?a:e,deviceListError:a,streamError:e}}function Y(){const[n,r]=i.exports.useState([]),[a,c]=i.exports.useState();return i.exports.useEffect(()=>{if(!("mediaDevices"in navigator)){c(new Error("DeviceList not supported"));return}const e=()=>{navigator.mediaDevices.enumerateDevices().then(r).catch(c)};return e(),navigator.mediaDevices.addEventListener("devicechange",e),()=>{navigator.mediaDevices.removeEventListener("devicechange",e)}},[]),{devices:n,error:a}}function Z(n={video:!0,audio:!1}){const[r,a]=i.exports.useState(n),[c,o]=i.exports.useState(),[e,s]=i.exports.useState(),p=i.exports.useRef(),m=v=>{p.current=v,o(v)};return i.exports.useEffect(()=>{if(!("mediaDevices"in navigator)){s(new Error("VideoStream not supported"));return}return navigator.mediaDevices.getUserMedia(r).then(m).catch(s),()=>{var x;(x=p.current)==null||x.getTracks().forEach(y=>y.stop())}},[r]),{setConstraints:a,stream:c,error:e}}const ee="_root_ajhqc_1",te="_video_ajhqc_11",oe="_canvas_ajhqc_16";var S={root:ee,video:te,canvas:oe};function re(){return d("div",{className:S.root,children:[t("p",{children:"About"}),t(ne,{})]})}function ne(){const{devices:n,activeDeviceIds:r,setConstraints:a,stream:c,error:o}=X({video:{facingMode:"user"},audio:!1}),e=i.exports.useRef(null),s=i.exports.useRef(document.createElement("canvas")),p=n.filter(l=>l.kind=="videoinput"),m=p.find(l=>r==null?void 0:r.includes(l.deviceId));i.exports.useEffect(()=>{c!=null&&e.current!=null&&(e.current.srcObject=c)},[c]);const[v,x]=i.exports.useState(),y=async()=>{const l=e.current,h=s.current;h.width=l.videoWidth,h.height=l.videoHeight;const k=h.getContext("2d");k==null||k.drawImage(l,0,0,h.width,h.height);const D=await se(h,"image/png");x(URL.createObjectURL(D))};return o?t("p",{children:o==null?void 0:o.toString()}):"mediaDevices"in navigator?d(I,{children:[t("select",{value:m==null?void 0:m.deviceId,onChange:l=>a({video:{deviceId:l.target.value},audio:!1}),children:p.map(l=>t("option",{value:l.deviceId,children:l.label},l.deviceId))}),t("video",{ref:e,className:S.video,autoPlay:!0,playsInline:!0}),t("button",{onClick:y,children:"Capture"}),t("img",{src:v})]}):d(I,{children:[t("p",{children:"Direct camera usage not supported, using input fallback."}),t("input",{type:"file",accept:"image/*",capture:"environment"}),t("input",{type:"file",accept:"image/*"})]})}const se=(n,r,a)=>new Promise((c,o)=>n.toBlob(e=>{if(e==null)return o(new Error("Empty Blob"));c(e)},r,a));U().then(()=>{L.render(t(j.StrictMode,{children:t(A,{basename:"/pwa-test/",children:t(C,{children:d(g,{path:"/",element:t(M,{}),children:[t(g,{index:!0,element:t(K,{})}),t(g,{path:"/:todoId",element:t(z,{})}),t(g,{path:"/sync",element:t(Q,{})}),t(g,{path:"/about",element:t(re,{})})]})})})}),document.getElementById("root"))});"serviceWorker"in navigator?navigator.serviceWorker.register("./service-worker.js",{}).then(n=>{console.log("Registration succeeded. Scope is "+n.scope)}).catch(n=>{debugger;console.log("Registration failed with "+n)}):console.error("Wont work!");
