import{j as S,L as b,O,l as M,r as l,u as P,a as B,R as A,b as W,B as F,c as U,d as g}from"./vendor.870b9123.js";const q=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function a(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerpolicy&&(t.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?t.credentials="include":r.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function c(r){if(r.ep)return;r.ep=!0;const t=a(r);fetch(r.href,t)}};q();const H="_root_1pim7_1";var C={root:H};const _=o=>(...s)=>s.map(a=>o[a]).join(" ");var k="/pwa-test/assets/checkbox.bce85b74.svg";const e=S.exports.jsx,i=S.exports.jsxs,K=S.exports.Fragment,z=_(C);function V(o){return e("div",{className:z("root"),children:e(b,{to:"/",children:i("header",{className:C.Header,children:[e("h1",{children:"PWA test"}),e("img",{src:k,className:C["App-logo"],alt:"logo"})]})})})}const G="_background_1akpy_1",J="_root_1akpy_18";var Q={background:G,root:J};const X="_root_6s1qf_1",Y="_item_6s1qf_10";var Z={root:X,item:Y};const w=_(Z);function ee(o){return i("nav",{className:w("root"),children:[i(b,{to:"/",className:w("item"),children:[e("img",{src:k,alt:"logo"}),e("span",{children:"todo"})]}),i(b,{to:"/sync",className:w("item"),children:[e("img",{src:k,alt:"logo"}),e("span",{children:"sync"})]}),i(b,{to:"/about",className:w("item"),children:[e("img",{src:k,alt:"logo"}),e("span",{children:"about"})]}),i(b,{to:"/camera",className:w("item"),children:[e("img",{src:k,alt:"logo"}),e("span",{children:"camera"})]})]})}const D=_(Q);function te(){return e("div",{className:D("background"),children:i("div",{className:D("root"),children:[e(V,{}),e("main",{children:e(O,{})}),e(ee,{})]})})}const oe={name:"PWA test",storeName:"pwa_test",version:1,description:"Offline storage for the app data"},h=M.createInstance(oe),y="tasks";async function se(){if(await h.getItem(y)!=null)return;const s=[{text:"Build tools",checked:!0},{text:"Create page layout",checked:!0},{text:"Input fields",checked:!0},{text:"Offline data storage",checked:!0},{text:"Upload images",checked:!1}];await h.setItem(y,s)}var re={"Todo-list":"_Todo-list_1spee_1","Todo-list-item":"_Todo-list-item_1spee_12","Todo-row-box":"_Todo-row-box_1spee_20","Todo-row-label":"_Todo-row-label_1spee_27","Todo-row-checkbox":"_Todo-row-checkbox_1spee_33","Todo-row-button":"_Todo-row-button_1spee_38","Todo-input-box":"_Todo-input-box_1spee_44","Todo-input-text":"_Todo-input-text_1spee_51","Todo-input-button":"_Todo-input-button_1spee_58"};const u=_(re);function ne(){const[o,s]=l.exports.useState([]);l.exports.useEffect(()=>{h.getItem(y).then(t=>s(t!=null?t:[])).catch(t=>console.error("failed to load!",t))},[]),l.exports.useEffect(()=>{h.setItem(y,o).catch(t=>console.error("failed to save!",t))},[o]);const a=t=>{const n=[...o];n[t].checked=!n[t].checked,s(n)},c=t=>{const n=[...o,t];s(n)},r=t=>{const n=o.filter((m,v)=>v!=t);s(n)};return i("ol",{className:u("Todo-list"),children:[o.map((t,n)=>e("li",{className:u("Todo-list-item"),children:i("div",{className:u("Todo-row-box"),children:[i("label",{className:u("Todo-row-label"),children:[e("input",{type:"checkbox",className:u("Todo-row-checkbox"),name:`${n}_${t.text}`,checked:t.checked,onChange:()=>a(n)}),t.text]}),e("button",{className:u("Todo-row-button"),onClick:m=>{m.preventDefault(),r(n)},children:"Remove"})]})},n)),e(ae,{addItem:c})]})}function ae(o){return e("li",{className:u("Todo-list-item"),children:i("form",{className:u("Todo-input-box"),onSubmit:s=>{s.preventDefault();const c=new FormData(s.currentTarget).get("new-item");c!=null&&(c instanceof File||(o.addItem({text:c,checked:!1}),s.currentTarget.reset()))},children:[e("input",{className:u("Todo-input-text"),name:"new-item",type:"text",placeholder:"New todo item..."}),e("button",{type:"submit",className:u("Todo-input-button"),children:"Add"})]})})}function ce(o={video:{facingMode:"environment"},audio:!1}){const{devices:s,error:a}=ie(),{setConstraints:c,stream:r,error:t}=le(o),n=r==null?void 0:r.getTracks().map(m=>m.getSettings().deviceId);return{devices:s,activeDeviceIds:n,setConstraints:c,stream:r,error:a!=null?a:t,deviceListError:a,streamError:t}}function ie(){const[o,s]=l.exports.useState([]),[a,c]=l.exports.useState();return l.exports.useEffect(()=>{if(!("mediaDevices"in navigator)){c(new Error("DeviceList not supported"));return}const t=()=>{navigator.mediaDevices.enumerateDevices().then(s).catch(c)};return t(),navigator.mediaDevices.addEventListener("devicechange",t),()=>{navigator.mediaDevices.removeEventListener("devicechange",t)}},[]),{devices:o,error:a}}function le(o={video:!0,audio:!1}){const[s,a]=l.exports.useState(o),[c,r]=l.exports.useState(),[t,n]=l.exports.useState(),m=l.exports.useRef(),v=p=>{m.current=p,r(p)};return l.exports.useEffect(()=>{if(!("mediaDevices"in navigator)){n(new Error("VideoStream not supported"));return}return navigator.mediaDevices.getUserMedia(s).then(v).catch(n),()=>{var N;(N=m.current)==null||N.getTracks().forEach(T=>T.stop())}},[s]),{setConstraints:a,stream:c,error:t}}function E(o){const{devices:s,activeDeviceIds:a,setConstraints:c,stream:r,error:t}=ce({video:{facingMode:"user"},audio:!1}),n=l.exports.useRef(null),m=l.exports.useRef(document.createElement("canvas")),v=s.filter(d=>d.kind=="videoinput"),p=v.find(d=>a==null?void 0:a.includes(d.deviceId));l.exports.useEffect(()=>{r!=null&&n.current!=null&&(n.current.srcObject=r)},[r]);const[N,T]=l.exports.useState(),j=async()=>{var R;const d=n.current,f=m.current;f.width=d.videoWidth,f.height=d.videoHeight;const I=f.getContext("2d");I==null||I.drawImage(d,0,0,f.width,f.height);const $=await de(f,"image/png");T(URL.createObjectURL($)),(R=o.onCapture)==null||R.call(o,$)};return t?e("p",{children:t==null?void 0:t.toString()}):"mediaDevices"in navigator?i("div",{className:o.className,children:[e("video",{ref:n,className:o.videoClassName,autoPlay:!0,playsInline:!0}),e("select",{className:o.selectClassName,value:p==null?void 0:p.deviceId,onChange:d=>c({video:{deviceId:d.target.value},audio:!1}),children:v.map(d=>e("option",{value:d.deviceId,children:d.label},d.deviceId))}),e("button",{className:o.captureClassName,onClick:j,children:"Capture"}),e("img",{src:N})]}):i(K,{children:[e("p",{children:"Direct camera usage not supported, using input fallback."}),e("input",{type:"file",accept:"image/*",capture:"environment"}),e("input",{type:"file",accept:"image/*"})]})}const de=(o,s,a)=>new Promise((c,r)=>o.toBlob(t=>{if(t==null)return r(new Error("Empty Blob"));c(t)},s,a)),ue="_root_1m46i_1";var me={root:ue};const pe=_(me);function he(){return i("div",{className:pe("root"),children:[e("p",{children:"This about page is mainly used as a testing playground."}),e(E,{})]})}const ve="_Sync_1czkv_1";var L={Sync:ve};function fe(){const[o,s]=l.exports.useState([]);return l.exports.useEffect(()=>{(async()=>{const t=(await h.keys()).filter(n=>n.startsWith("picture")).map(async n=>({path:n,blob:await h.getItem(n)}));s(await Promise.all(t))})().catch(c=>console.error("experiment!",c))},[]),e("div",{className:L.Sync,children:e("div",{className:L.main,children:o.map(a=>i("div",{children:[a.path,e("img",{src:URL.createObjectURL(a.blob)})]},a.path))})})}const ge="_text_1v7wx_1";var _e={text:ge};function xe(o){return e("form",{onSubmit:s=>{s.preventDefault()},children:e("input",{className:_e.text,name:"text",type:"text",placeholder:`Todo item ${o.todoId}...`})})}function be(){const s=P()["todo-id"];return s==null?e("div",{children:"Missing 'todo-id' path parameter."}):e(xe,{todoId:s})}const ke="_root_kuvws_1",we="_camera_kuvws_10",Ne="_video_kuvws_22",ye="_select_kuvws_34",Te="_capture_kuvws_37",Ie="_back_kuvws_40";var Se={root:ke,camera:we,video:Ne,select:ye,capture:Te,back:Ie};const x=_(Se);function Ce(){const o=B(),s=a=>{h.setItem(`picture-${Math.floor(Math.random()*1e4)}`,a)};return i("div",{className:x("root"),children:[e(E,{className:x("camera"),selectClassName:x("select"),captureClassName:x("capture"),videoClassName:x("video"),onCapture:s}),e("button",{className:x("back"),onClick:()=>o("/"),children:"Back"})]})}se().then(()=>{A.render(e(W.StrictMode,{children:e(F,{basename:"/pwa-test/",children:i(U,{children:[i(g,{path:"/",element:e(te,{}),children:[e(g,{index:!0,element:e(ne,{})}),e(g,{path:"/sync",element:e(fe,{})}),e(g,{path:"/todo/:todo-id",element:e(be,{})}),e(g,{path:"/about",element:e(he,{})})]}),e(g,{path:"/camera",element:e(Ce,{})})]})})}),document.getElementById("root"))});"serviceWorker"in navigator?navigator.serviceWorker.register("./service-worker.js",{}).then(o=>{console.log("Registration succeeded. Scope is "+o.scope)}).catch(o=>{debugger;console.log("Registration failed with "+o)}):console.error("Wont work!");
